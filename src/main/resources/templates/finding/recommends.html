<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head th:replace="common/header::copy"></head>
<body>
<div class="layui-tab layui-tab-brief">
    <ul class="layui-tab-title">
        <li class="layui-this">个人录书</li>
    </ul>
    <div class="layui-tab-content" style="height: 100px;">
        <!--<div class="layui-tab-item layui-show">-->
            <!--<table class="layui-hide" id="notFinshs" lay-filter="demo"></table>-->
        <!--</div>-->
        <div class="layui-tab-item layui-show">
            <table class="layui-hide" id="Finshs" lay-filter="demo1"></table>
        </div>
    </div>
</div>
<!--<script type="text/html" id="switchTpl">-->
    <!--<input type="checkbox" value="{{d.id}}" lay-skin="switch" lay-text="否|是" lay-filter="sexDemo" {{ d.recommend== 1-->
           <!--? 'checked' : '' }} >-->
<!--</script>-->
<script type="text/html" id="switchTpl1">
    <input type="checkbox" value="{{d.id}}" lay-skin="switch" lay-text="否|是" lay-filter="sexDemo1" {{ d.recommend== 1
           ? 'checked' : '' }} >
</script>
<script th:replace="common/script::copy"></script>
<script type="text/javascript" th:inline="javascript">
    layui.use(['table', 'jquery', 'form'], function () {
        var table = layui.table
            , form = layui.form
            , $ = layui.jquery;
        // table.render({
        //     elem: '#notFinshs'
        //     , url: context + '/invitation/chaXunPoints'
        //     , cellMinWidth: 80
        //     , cols: [[
        //         {field: 'id', title: 'ID', width: "20%"}
        //         , {field: 'dName', title: '打卡名称', width: "50%"}
        //         , {field: 'recommend', title: '是否推荐', width: "30%", name: "sysData", templet: '#switchTpl', unresize: true}//
        //     ]]
        //     , page: true
        // });
        //
        // form.on('switch(sexDemo)', function (obj) {
        //     if (obj.elem.checked == true) {
        //         var x=obj.elem.checked;
        //
        //         $.post(context + "/invitation/insertRecommend", {"id": this.value, "gameType": 0}, function (res) {
        //             console.log(res);
        //             if (res.message != "推荐成功") {
        //                 obj.elem.checked=!x;
        //                 form.render();
        //                 layer.confirm('推荐数已超过三个，请取消推荐后重新推荐', {
        //                     btn: '确定'
        //                     }
        //                 );
        //             } else {
        //                 layer.alert("推荐成功");
        //             }
        //         })
        //     } else {
        //         $.post(context+"/invitation/deleteRecommend",{"id":this.value},function (res) {
        //             if(res.message){
        //                 layer.alert("取消推荐成功");
        //             }
        //         })
        //     }
        // });

        table.render({
            elem: '#Finshs'
            , url: context + '/invitation/chaXunTravel'
            , cellMinWidth: 80
            , cols: [[
                {field: 'id', title: 'ID'}
                , {field: 'lName', title: '打卡名称'}
                , { field: 'recommend',title: '推荐', name: "sysData",templet: '#switchTpl1',unresize: true }//
            ]]
            , page: true
        });
        form.on('switch(sexDemo1)', function (obj) {
            if (obj.elem.checked == true) {
                var x=obj.elem.checked;

                $.post(context + "/invitation/insertTravelRecommend", {"id": this.value, "gameType": 1}, function (res) {
                    console.log(res);
                    if (res.message != "推荐成功") {

                        obj.elem.checked=!x;
                        form.render();
                        layer.confirm('推荐数已超过三个，请取消推荐后重新推荐', {
                                btn: '确定'
                            }
                        );
                    } else {
                        // parent.window.location.href=context+"/invitation/homepage";//刷新父窗口
                        layer.alert("推荐成功");
                    }
                })
            } else {
                $.post(context+"/invitation/deleteTravelRecommend",{"id":this.value},function (res) {
                    if(res.message){
                        // parent.window.location.href=context+"/invitation/homepage";//刷新父窗口
                        layer.alert("取消推荐成功");
                    }
                })
            }
        });
    });
</script>
</body>
</html>